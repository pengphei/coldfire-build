DEVICE    MCF5282
FLASHBAR  00000000
RAMBAR1   20000000
IPSBAR    40000000
FLASHBASE 00000000

INSTRAM   RAMBAR1		
DATARAM   RAMBAR1
DATASIZE  0x400

//FLASHALG  MCF5282CFM(1x32)
FLASHALG   AM29LV160DB(1x16)

.init
wcreg	RAMBAR1 	RAMBAR1 0x1
wcreg	FLASHBAR 	FLASHBAR 0x1

write.l IPSBAR	0x00000000	IPSBAR 0x1

//write.w	IPSBAR	0x00000080	FLASHBASE>>0x10 0x00000000
//write.w	IPSBAR	0x00000080	0x3000
//write.w	IPSBAR	0x0000008A	0x1D80
//write.l	IPSBAR	0x00000084	0x001F0001

/* turn off watchdog */
write.w	IPSBAR	0x00140000	0x0000

/* Make sure external buss is set to 32-bits */
write.b	IPSBAR	0x00100050	0xC0

/* init CFM CLK register */
/* writing byte 0x49 to address IPSBAR + 0x1D_0002: Setting Fclk to 187.5 Khz with Fsys @33Mhz */
write.b IPSBAR	0x001D0002	0x49

/* writing long 0x00000000 to address IPSBAR + 0x1D_0010 */
write.l IPSBAR	0x001D0010	0x00000000

write.w	IPSBAR	0x00000080	0x0010
write.w	IPSBAR	0x0000008A	0x1D80
write.l	IPSBAR	0x00000084	0x00FF0001
